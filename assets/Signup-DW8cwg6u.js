import{r as o,u as G,j as a,L,d as F,y as i}from"./index-BWAzDsj0.js";import{S as P,a as d}from"./index-JF6aI-qR.js";import{T as p,F as W}from"./index-Bn6leUYA.js";import{i as B}from"./main-bg-W5A1Onlo.js";import{S as I,m as R,s as $}from"./motion-BDPao5W_.js";import{B as t,a as v}from"./Button-ChG3pmet.js";import{T as c}from"./Typography-Badc2-FJ.js";const M=()=>{const[b,m]=o.useState(!1),[s,N]=o.useState({name:"",email:"",password:""}),[u,f]=o.useState({otp:"",email:""}),[r,n]=o.useState(null),[l,C]=o.useState({name:"",email:"",password:""}),g=G(),[j,w]=o.useState(!1),y=()=>{const e={name:"",email:"",password:""};return s.name.trim().length<3&&(e.name="Name must have minimum 3 characters."),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email.trim())||(e.email="Enter a valid email."),s.password.trim().length<5&&(e.password="Password must contain a minimum of 5 characters."),C(e),!Object.values(e).some(A=>A!=="")},S=async()=>{if(y()){m(!0);try{const e=await d.post("https://todo-cloudy.onrender.com/api/auth/createuser",s,{headers:{"Content-Type":"application/json"}});e.data.message?(w(!0),i.info(e.data.message),n(null)):e.status===400&&e.data.error&&(await n(e.data.error),i.error(r))}catch(e){d.isAxiosError(e)&&e.response?(await n(e.response.data.error),i.error(r),console.error(r)):(n("An unexpected error occurred."),i.error(r))}finally{m(!1)}}},T=async()=>{if(y()){m(!0);try{const e=await d.post("https://todo-cloudy.onrender.com/api/auth/verify-otp-createuser",u,{headers:{"Content-Type":"application/json"}});e.data.authToken?(F.setItem("authToken",e.data.authToken),g("/mainpage"),n(null)):e.status===400&&e.data.error&&(await n(e.data.error),i.error(`${r}`))}catch(e){d.isAxiosError(e)&&e.response?(await n(e.response.data.error),i.error(r),console.error(r)):(n("An unexpected error occurred."),i.error(r))}finally{m(!1),w(!1)}}},E=async e=>{e.preventDefault(),await S()},k=()=>{window.location.href="https://todo-cloudy.onrender.com/api/auth/google"},O=()=>{window.location.href="https://todo-cloudy.onrender.com/api/auth/github"},h=e=>{N({...s,[e.target.name]:e.target.value})};o.useEffect(()=>{f(e=>({...e,email:s.email}))},[s.email]);const D=e=>{const x=e.target.value;/^\d{0,6}$/.test(x)&&f({...u,otp:x})};return a.jsxs(I,{children:[a.jsx("img",{alt:"nature",className:"bg-img",src:B}),a.jsx(R.div,{initial:"hidden",animate:"show",variants:$("right","tween",.1,1),children:a.jsx(t,{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center",children:a.jsxs(t,{className:"signup-box",children:[a.jsx(c,{variant:"h4",color:"white",textAlign:"center",fontWeight:"bold",pt:3,children:"Signup"}),a.jsxs("form",{onSubmit:E,className:"mx-6",children:[a.jsxs(t,{display:"flex",flexDirection:"column",gap:1,children:[a.jsxs(t,{children:[a.jsx(c,{className:"label",children:"Name"}),a.jsx(p,{fullWidth:!0,type:"text",name:"name",id:"name",value:s.name,onChange:h,error:!!l.name,helperText:l.name,className:"input-login"})]}),a.jsxs(t,{children:[a.jsx(c,{className:"label",children:"Email"}),a.jsx(p,{fullWidth:!0,type:"email",name:"email",id:"email",value:s.email,onChange:h,error:!!l.email,helperText:l.email,className:"input-login"})]}),j?a.jsxs(t,{children:[a.jsx(c,{className:"label",children:"OTP"}),a.jsx(p,{fullWidth:!0,type:"otp",name:"OTP",id:"otp",value:u.otp,onChange:D,className:"input-login"})]}):a.jsxs(t,{children:[a.jsx(c,{className:"label",children:"Password"}),a.jsx(p,{fullWidth:!0,type:"password",name:"password",id:"password",value:s.password,onChange:h,error:!!l.password,helperText:l.password,className:"input-login"})]})]}),b?a.jsx(L,{}):j?a.jsx(t,{mt:1,mb:2,display:"flex",justifyContent:"center",children:a.jsx(v,{sx:{height:"35px",width:"200px"},variant:"contained",onClick:T,children:"Signup"})}):a.jsx(t,{mt:1,mb:2,display:"flex",justifyContent:"center",children:a.jsx(v,{variant:"contained",type:"submit",sx:{height:"35px",width:"200px"},children:"Generate OTP"})}),a.jsxs(t,{display:"flex",flexDirection:"row",gap:10,justifyContent:"center",children:[a.jsx(W,{className:"font-bold cursor-pointer text-2xl",onClick:k}),a.jsx(P,{className:"github-icon text-2xl",onClick:O})]}),a.jsxs(t,{className:"bottom",children:["Already have an account?"," ",a.jsx("span",{className:"bottom-link",onClick:()=>g("/login"),children:"Login"}),"."]})]})]})})})]})};export{M as default};

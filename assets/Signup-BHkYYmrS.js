import{r as n,u as A,j as a,L as G,d as L,y as i}from"./index-CwXaAz0R.js";import{F,S as P,a as d}from"./index-D-6o8Nl7.js";import{i as B}from"./main-bg-CmF2ve_g.js";import{S as I,m as R,s as $}from"./motion-C-sMM3ck.js";import{B as t}from"./Box-H1PaT7Oj.js";import{T as c}from"./Typography-BAcOIHa2.js";import{T as p}from"./TextField-BbZNygdv.js";import{B as H}from"./Button-DL9VP1W7.js";const Q=()=>{const[b,m]=n.useState(!1),[s,v]=n.useState({name:"",email:"",password:""}),[u,g]=n.useState({otp:"",email:""}),[r,o]=n.useState(null),[l,N]=n.useState({name:"",email:"",password:""}),f=A(),[j,w]=n.useState(!1),y=()=>{const e={name:"",email:"",password:""};return s.name.trim().length<3&&(e.name="Name must have minimum 3 characters."),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.email.trim())||(e.email="Enter a valid email."),s.password.trim().length<5&&(e.password="Password must contain a minimum of 5 characters."),N(e),!Object.values(e).some(D=>D!=="")},S=async()=>{if(y()){m(!0);try{const e=await d.post("https://todo-cloudy.onrender.com/api/auth/createuser",s,{headers:{"Content-Type":"application/json"}});e.data.message?(w(!0),i.info(e.data.message),o(null)):e.status===400&&e.data.error&&(await o(e.data.error),i.error(r))}catch(e){d.isAxiosError(e)&&e.response?(await o(e.response.data.error),i.error(r),console.error(r)):(o("An unexpected error occurred."),i.error(r))}finally{m(!1)}}},T=async()=>{if(y()){m(!0);try{const e=await d.post("https://todo-cloudy.onrender.com/api/auth/verify-otp-createuser",u,{headers:{"Content-Type":"application/json"}});e.data.authToken?(L.setItem("authToken",e.data.authToken),f("/mainpage"),o(null)):e.status===400&&e.data.error&&(await o(e.data.error),i.error(`${r}`))}catch(e){d.isAxiosError(e)&&e.response?(await o(e.response.data.error),i.error(r),console.error(r)):(o("An unexpected error occurred."),i.error(r))}finally{m(!1),w(!1)}}},C=async e=>{e.preventDefault(),await S()},E=()=>{window.location.href="https://todo-cloudy.onrender.com/api/auth/google"},k=()=>{window.location.href="https://todo-cloudy.onrender.com/api/auth/github"},h=e=>{v({...s,[e.target.name]:e.target.value})};n.useEffect(()=>{g(e=>({...e,email:s.email}))},[s.email]);const O=e=>{const x=e.target.value;/^\d{0,6}$/.test(x)&&g({...u,otp:x})};return a.jsxs(I,{children:[a.jsx("img",{alt:"nature",className:"bg-img",src:B}),a.jsx(R.div,{initial:"hidden",animate:"show",variants:$("right","tween",.1,1),children:a.jsx(t,{minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center",children:a.jsxs(t,{className:"signup-box",children:[a.jsx(c,{variant:"h4",color:"white",textAlign:"center",fontWeight:"bold",pt:3,children:"Signup"}),a.jsxs("form",{onSubmit:C,className:"my-1 mx-6",children:[a.jsxs(t,{display:"flex",flexDirection:"column",gap:2,children:[a.jsxs(t,{children:[a.jsx(c,{className:"label",children:"Name"}),a.jsx(p,{type:"text",name:"name",id:"name",value:s.name,onChange:h,error:!!l.name,helperText:l.name,className:"input-login"})]}),a.jsxs(t,{children:[a.jsx(c,{className:"label",children:"Email"}),a.jsx(p,{type:"email",name:"email",id:"email",value:s.email,onChange:h,error:!!l.email,helperText:l.email,className:"input-login"})]}),j?a.jsxs(t,{children:[a.jsx(c,{className:"label",children:"OTP"}),a.jsx(p,{type:"otp",name:"OTP",id:"otp",value:u.otp,onChange:O,className:"input-login"})]}):a.jsxs(t,{children:[a.jsx(c,{className:"label",children:"Password"}),a.jsx(p,{type:"password",name:"password",id:"password",value:s.password,onChange:h,error:!!l.password,helperText:l.password,className:"input-login"})]})]}),b?a.jsx(G,{}):j?a.jsx(t,{className:"submit-button mt-6",children:a.jsx(H,{onClick:T,children:"Signup"})}):a.jsx(t,{className:"submit-button mt-6",children:a.jsx("button",{type:"submit",children:"Generate OTP"})}),a.jsxs(t,{display:"flex",flexDirection:"row",gap:10,justifyContent:"center",children:[a.jsx(F,{className:"font-bold cursor-pointer text-2xl",onClick:E}),a.jsx(P,{className:"github-icon text-2xl",onClick:k})]}),a.jsxs(t,{className:"bottom",children:["Already have an account?"," ",a.jsx("span",{className:"bottom-link",onClick:()=>f("/login"),children:"Login"}),"."]})]})]})})})]})};export{Q as default};
